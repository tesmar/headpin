= include_javascripts :treetable
= include_javascripts :subscription
.grid_16
  %h3= _('Current Subscriptions')
  .tree
    - if @subscriptions.nil? || @subscriptions.empty?
      %p= _('No Subscriptions Available')
    - else
      %table#subscriptionTable
        - group = nil  
        %thead
          %th= _('Product')
          %th= _('Quantity')
          %th= _('Contract')
          %th= _('Support Level')
          %th= _('Arch')      
          %th= _('Begins')
          %th= _('Expires')
        %tbody
          - @subscriptions.each do |sub|
            - new_group = sub.name
            - if (new_group != group)
              - group = sub.name
              %tr{:id => group}
                %td= sub.productName
                %td
                %td
                %td
                %td
                %td
                %td
              %tr{:class => "child-of-#{group}", :id => sub.uuid}
                %td= sub.productName
                %td
                  = sub.consumed
                  = "/"
                  = sub.quantity
                %td=sub.contractNumber
                %td= sub.productAttributes["support_level"] ? sub.productAttributes["support_level"]["value"] : ""
                %td= sub.productAttributes["arch"] ? sub.productAttributes["arch"]["value"] : ""
                %td=l sub.startDate
                %td=l sub.endDate
